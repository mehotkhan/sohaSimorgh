(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{636:function(t,e,a){"use strict";a.r(e);var n=a(59),r=a(528),s=(a(109),[{type:"public-key",alg:-7}]),u={authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"required"};a(585),a(10),a(587),a(593),a(595),a(596),a(597),a(600),a(601),a(602),a(603),a(604),a(605),a(606),a(607),a(609),a(610),a(611),a(612),a(613),a(614),a(615),a(616),a(621),a(622),a(623),a(187),a(81),a(60),a(346),a(342),a(624);function i(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function o(t){return btoa(i(t))}function l(t){return JSON.parse(i(t))}function c(){for(var t=new Uint8Array(16),e=0;e<16;e++)t[e]=Math.round(255*Math.random());return t}function d(){for(var t=new Uint8Array(32),e=0;e<32;e++)t[e]=Math.round(255*Math.random());return t.buffer}var p={name:"p2pLogin",mounted:function(){if(this.user=this.$gun.user().recall({sessionStorage:!0}),this.sea=SEA,this.user.is){this.loggedIN=!0;var t=this.user.is.pub,e=this;this.$gun.user(t).once((function(a,n){e.myAlias=a&&a.alias?a.alias:"none",e.myPub=t||epub}))}},data:function(){return{inputData:{username:"",password:"",relyingParty:{name:"Ali Zemani Personal Website",id:"alizemani.ir"},attachment:"any",attestation:"none"},userDetails:null,savedCred:null,assertion:null,userCreated:null,userAllert:null,myAlias:"",myPub:"",loggedIN:!1,loginWithPass:!1}},computed:{formattedUserDetails:function(){return this.userDetails?Object(r.a)(Object(r.a)({},this.userDetails),{},{id:o(this.userDetails.id)}):null},formattedSavedCred:function(){return this.savedCred?(t=this.savedCred,Object(r.a)(Object(r.a)({},t),{},{rawId:o(t.rawId),response:Object(r.a)(Object(r.a)({},t.response),{},{attestationObject:o(t.response.attestationObject),clientDataJSON:l(t.response.clientDataJSON)})})):null;var t},formattedAssertion:function(){return this.assertion?(t=this.assertion,Object(r.a)(Object(r.a)({},t),{},{rawId:o(t.rawId),response:Object(r.a)(Object(r.a)({},t.response),{},{authenticatorData:o(t.response.authenticatorData),clientDataJSON:l(t.response.clientDataJSON),signature:o(t.response.signature)})})):null;var t}},methods:{webAuthValidate:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$gun.get("~@"+t.inputData.username);case 2:return e.next=4,t.$gun.get("~@"+t.inputData.username).once((function(e){e?t.gunAuthenticate():t.gunRegister()}));case 4:case"end":return e.stop()}}),e)})))()},passwordValidate:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$gun.get("~@"+t.inputData.username);case 2:return e.next=4,t.$gun.get("~@"+t.inputData.username).once((function(e){e?t.gunAuthenticate():t.gunRegister()}));case 4:case"end":return e.stop()}}),e)})))()},gunRegister:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t,t.user.create(t.inputData.username,t.inputData.password,(function(e){if(e.err)a.userAllert=e.err;else{var n=t.user.is.pub,r=t;t.$gun.user(n).once((function(t,e){r.myAlias=t.alias,r.myPub=n,r.loggedIN=!0,r.userCreated=!0,r.userAllert=null,r.$forceUpdate()}))}}));case 2:case"end":return e.stop()}}),e)})))()},gunAuthenticate:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t,t.user.auth(t.inputData.username,t.inputData.password,(function(e){if(e.err)a.userAllert=e.err,a.loginWithPass=!1;else{var n=t.user.is.pub,r=t;t.$gun.user(n).once((function(t,e){r.myAlias=t.alias,r.myPub=n})),r.userAllert=null,r.loggedIN=!0,r.$forceUpdate()}}));case 2:case"end":return e.stop()}}),e)})))()},gunExit:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.$gun.user().leave(),t.loggedIN=!1,t.$forceUpdate();case 3:case"end":return e.stop()}}),e)})))()},register:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={rp:t.inputData.relyingParty,pubKeyCredParams:s,timeout:6e4,attestation:t.inputData.attestation,authenticatorSelection:"any"===t.inputData.attachment?void 0:Object(r.a)(Object(r.a)({},u),{},{authenticatorAttachment:t.inputData.attachment}),challenge:d(),user:{id:c(),name:t.inputData.username,displayName:t.inputData.username}},console.log({publicKey:a}),e.prev=2,e.next=5,navigator.credentials.create({publicKey:a});case 5:n=e.sent,t.savedCred=n,t.userDetails=a.user,console.log("Credential obtained",t.savedCred),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))()},authenticate:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.savedCred){e.next=3;break}return alert("You must register first"),e.abrupt("return");case 3:return a={rp:t.inputData.relyingParty,pubKeyCredParams:s,attestation:"indirect",timeout:6e4,challenge:d(),allowCredentials:[{id:t.savedCred.rawId,type:"public-key"}]},console.log({publicKey:a}),e.prev=5,e.next=8,navigator.credentials.get({publicKey:a});case 8:n=e.sent,console.log("Assertion obtained",n),t.assertion=n,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.error(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[5,13]])})))()},exit:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.assertion=null,t.savedCred=null;case 2:case"end":return e.stop()}}),e)})))()},customCode:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var a,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.sea.pair();case 2:a=e.sent,console.log(a),"alizemaniddsdsdsdssssd",t.$gun.user().auth(a,"alizemaniddsdsdsdssssd",null,(function(t){console.log(t)})),n=t,t.$gun.on("auth",(function(t){n.loggedIN=!0,console.log("Authentication was successful: ",t)})),console.log("------- start --------"),r=t.user.is,console.log(r),console.log("---------- end -----");case 12:case"end":return e.stop()}}),e)})))()}}},g=a(19),m=Object(g.a)(p,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("br"),t._v(" "),this.userCreated&&this.loggedIN?a("div",{staticClass:"uk-alert-success",attrs:{"uk-alert":""}},[a("a",{staticClass:"uk-alert-close",attrs:{"uk-close":""}}),t._v(" "),a("p",[t._v("شما با موفقیت عضو و وارد شدید.")])]):t._e(),t._v(" "),this.userAllert?a("div",{staticClass:"uk-alert-allert",attrs:{"uk-alert":""}},[a("a",{staticClass:"uk-alert-close",attrs:{"uk-close":""}}),t._v(" "),a("p",[t._v(t._s(this.userAllert))])]):t._e(),t._v(" "),a("div",{staticClass:"uk-grid-small uk-visible-toggle",attrs:{"uk-grid":"",tabindex:"-1"}},[a("div",{staticClass:"uk-width-1-3@s"},[t.loggedIN||t.loginWithPass?t._e():a("input",{directives:[{name:"model",rawName:"v-model",value:t.inputData.username,expression:"inputData.username"}],staticClass:"\n          uk-input uk-width-1-1 uk-form-small uk-padding-remove-horizontal\n        ",attrs:{type:"text",placeholder:"نام کاربری خود را وارد کنید."},domProps:{value:t.inputData.username},on:{input:function(e){e.target.composing||t.$set(t.inputData,"username",e.target.value)}}}),t._v(" "),!t.loggedIN&&t.loginWithPass?a("input",{directives:[{name:"model",rawName:"v-model",value:t.inputData.password,expression:"inputData.password"}],staticClass:"\n          uk-input uk-width-1-1 uk-form-small uk-padding-remove-horizontal\n        ",attrs:{type:"password",placeholder:"پسورد خود را وارد کنید."},domProps:{value:t.inputData.password},on:{input:function(e){e.target.composing||t.$set(t.inputData,"password",e.target.value)}}}):t._e(),t._v(" "),t.loggedIN?a("p",{staticClass:"uk-text-right uk-padding-right-small uk-margin-small-top"},[t._v("\n        سلام "+t._s(t.myAlias)+"\n      ")]):t._e()]),t._v(" "),a("div",{staticClass:"uk-width-1-3@s"},[t.loggedIN?t._e():a("button",{staticClass:"\n          uk-button\n          uk-button-small\n          uk-button-text\n          uk-width-1-1\n          uk-padding-remove-horizontal\n        ",attrs:{disabled:!t.inputData.username||t.loginWithPass},on:{click:t.webAuthValidate}},[t._v("\n        تایید هویت بایومتریک "),a("span",{attrs:{"uk-icon":"500px"}})]),t._v(" "),t.loggedIN?a("button",{staticClass:"\n          uk-button\n          uk-button-small\n          uk-button-text\n          uk-width-1-1\n          uk-padding-remove-horizontal\n        ",attrs:{type:"button","uk-toggle":"target: #my-profile","uk-tooltip":"برای نمایش اطلاعات کاربری خود کلیک کنید"}},[t._v("\n        اطلاعات کاربری "),a("span",{attrs:{"uk-icon":"user"}})]):t._e()]),t._v(" "),a("div",{staticClass:"uk-width-1-3@s"},[t.loggedIN||t.loginWithPass?t._e():a("button",{staticClass:"uk-button uk-button-text uk-button-small uk-width-1-1",attrs:{disabled:!t.inputData.username&&!t.loginWithPass},on:{click:function(e){t.loginWithPass=!t.loginWithPass}}},[t._v("\n        تایید هویت با پس‌ورد "),a("span",{attrs:{"uk-icon":"hashtag"}})]),t._v(" "),!t.loggedIN&&t.loginWithPass?a("button",{staticClass:"uk-button uk-button-text uk-button-small uk-width-1-1",attrs:{disabled:!t.inputData.username},on:{click:t.passwordValidate}},[t._v("\n        ورود پا پسورد "),a("span",{attrs:{"uk-icon":"hashtag"}})]):t._e(),t._v(" "),t.loggedIN?a("button",{staticClass:"uk-button uk-button-text uk-button-small uk-width-1-1",on:{click:t.gunExit}},[t._v("\n        خروج "),a("span",{attrs:{"uk-icon":"sign-out"}})]):t._e()]),t._v(" "),a("div",{staticClass:"uk-width-1-3@s"},[a("div",{attrs:{id:"my-profile","uk-modal":""}},[a("div",{staticClass:"uk-modal-dialog uk-modal-body"},[a("h2",{staticClass:"uk-modal-title"},[t._v("پروفایل کابری")]),t._v(" "),a("p",[t._v("نام شما : "+t._s(this.myAlias))]),t._v(" "),a("p",[t._v("کلید عمومی شما :")]),t._v(" "),a("pre",[a("code",[t._v(" "+t._s(this.myPub))])]),t._v(" "),t._m(0)])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"uk-text-right"},[e("button",{staticClass:"uk-button uk-button-default uk-modal-close",attrs:{type:"button"}},[this._v("\n              بستن\n            ")])])}],!1,null,null,null);e.default=m.exports}}]);